<!DOCTYPE html>

<html lang="en">
<head>
	  <meta name="viewport" content="width=device-width, initial-scale=1.0">
	  
	  <meta charset="utf-8">
	  <title>Spanglish</title>
	  <meta name="description" content=""/>

	  <!-- Loading Bootstrap -->
	  <link href="flat-ui/bootstrap/css/bootstrap.css" rel="stylesheet">
	  <link href="css/spanglish.css" rel="stylesheet">
	  <link href="css/landing.css" rel="stylesheet">

	  <!-- Loading Flat UI -->
	  <link href="flat-ui/css/flat-ui.css" rel="stylesheet">
	  <link href="flat-ui/css/demo.css" rel="stylesheet">

	  <link rel="shortcut icon" href="flat-ui/flat-ui/images/favicon.ico">

	  <!-- HTML5 shim, for IE6-8 support of HTML5 elements. All other JS at the end of file. -->
	    <!--[if lt IE 9]>
	      <script src="flat-ui/js/html5shiv.js"></script>
	      <script src="flat-ui/js/respond.min.js"></script>
	      <![endif]-->
</head>
    <body>
    	<div class = "landingContainer">
    		<div id="fb-root"></div>
    		<script>
    		window.fbAsyncInit = function() {
  			        FB.init({
  			        appId      : '1452060145024625',
  			        status     : true, // check login status
  			        cookie     : true, // enable cookies to allow the server to access the session
  			        xfbml      : true  // parse XFBML
  	      			});
  
  				  	// Here we subscribe to the auth.authResponseChange JavaScript event. This event is fired
  				  	// for any authentication related change, such as login, logout or session refresh. This means that
  				  	// whenever someone who was previously logged out tries to log in again, the correct case below 
  				 	// will be handled. 
  				    /*
  				    FB.Event.subscribe('auth.authResponseChange', function(response) {
  					    // Here we specify what we do with the response anytime this event occurs. 
  					    if (response.status === 'connected') {
  					      // In this case, we're handling the situation where they 
  					      // has logged in to the app already. So, direct to chat.handlebars
 				      	  FB.api('/me', 
  								function(response) { 
									console.log("Welcome, " + response.name + "! ID: " + response.id); 
									window.location.replace("setsession/" + response.id);
								}
							);
  					    }
  			  		});
					*/
					
  				};
  
  				// Load the SDK asynchronously
  				(function(d){
  				   var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
  				   if (d.getElementById(id)) {return;}
  				   js = d.createElement('script'); js.id = id; js.async = true;
  				   js.src = "//connect.facebook.net/en_US/all.js";
  				   ref.parentNode.insertBefore(js, ref);
  				}(document));
  
  				function executeLogin() {
  					FB.login(function(response) {
  						if (response.authResponse) {
  	    					// the user has chosen to login via FB
  							FB.api('/me', 
  								function(response) { 
									scrapeFriends(response.name, response.id);
								}
							);
						} else {
  	   					 	// the user has cancelled the login
  						}
  					});

  					function scrapeFriends(name, id) {
						console.log("Welcome, " + name + "! ID: " + id);
			
						FB.api('/me/friends', 
                 			function(response) {

                 				console.log(response.name);
                 				var count = 0;
                 				var friends = new Array();
                 				if(response.data) {
                    				$.each(response.data,function(index,friend) {
                    					var friendID = friend.id;
                    					//console.log(friendID);
                    					friends[count] = friendID;
                    					count++;
                     				});
                    				//console.log(name + "'s friends: " + friends);
                    				window.location.replace("setsession/" + name + "/" + id + "/" + friends);
                   				} else {
                     				console.log("Error!");
                   				}
           					}
           				);

									
					}


  				}

			</script>		    	 
				<div class = "loginBox">
					<div class = "title">
						<h1> Spanglish </h1>
						<h6> Learn with Friends </h6>
					</div>

					<hr>

					<button class="btn btn-inverse" type="button" onclick ="executeLogin()">Get Started!</button>

					
				</div>
		</div>
			

	    <!-- Load JS here for greater good =============================-->
	    <script src="flat-ui/js/jquery-1.8.3.min.js"></script>
	    <script src="flat-ui/js/jquery-ui-1.10.3.custom.min.js"></script>
	    <script src="flat-ui/js/jquery.ui.touch-punch.min.js"></script>
	    <script src="flat-ui/js/bootstrap.min.js"></script>
	    <script src="flat-ui/js/bootstrap-select.js"></script>
	    <script src="flat-ui/js/bootstrap-switch.js"></script>
	    <script src="flat-ui/js/flatui-checkbox.js"></script>
	    <script src="flat-ui/js/flatui-radio.js"></script>
	    <script src="flat-ui/js/jquery.tagsinput.js"></script>
	    <script src="flat-ui/js/jquery.placeholder.js"></script>
	    <script src="flat-ui/js/jquery.stacktable.js"></script>
	    <script src="http://vjs.zencdn.net/4.3/video.js"></script>
	    <script src="flat-ui/js/application.js"></script>
  </body>
  </html>